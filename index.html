<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø­ÙØ¸ - Ù…Ø±ÙƒØ² Ø­Ø§Ù…Ù„ Ø§Ù„Ù…Ø³Ùƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');
        body { font-family: 'Amiri', serif; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Slider styling */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: pointer;
        }
        
        input[type="range"]::-webkit-slider-track {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            background: #10b981;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        input[type="range"]::-moz-range-track {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            border: none;
        }
        
        input[type="range"]::-moz-range-thumb {
            background: #10b981;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .review-slider::-webkit-slider-thumb {
            background: #3b82f6;
        }
        
        .review-slider::-moz-range-thumb {
            background: #3b82f6;
        }
        
        .student-name {
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 4px;
        }
        
        .student-name:hover {
            background-color: #f3f4f6;
        }
        
        .student-present {
            color: #059669;
            font-weight: 900;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .student-absent {
            color: #dc2626;
            font-weight: 900;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
            background-color: #fee2e2;
            border: 1px solid #fecaca;
        }
        
        .disabled-buttons button {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }
        
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
            .print-break { page-break-after: always; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 to-teal-100 min-h-screen">
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <h2 class="text-xl font-bold text-gray-800 mb-6 text-center">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ù…Ø´Ø±Ù</h2>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="passwordInput" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <div class="flex space-x-4 space-x-reverse">
                <button onclick="checkPassword()" class="flex-1 bg-emerald-600 text-white py-2 px-4 rounded-md hover:bg-emerald-700 transition-colors">
                    Ø¯Ø®ÙˆÙ„
                </button>
                <button onclick="closeLoginModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 transition-colors">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
            </div>
            <div id="loginError" class="text-red-600 text-sm mt-2 hidden">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©</div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-gradient-to-r from-emerald-600 to-teal-600 text-white shadow-lg no-print">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div class="bg-white/20 p-3 rounded-full">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2L2 7v10c0 5.55 3.84 9.74 9 11 5.16-1.26 9-5.45 9-11V7l-10-5z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">Ù…Ø±ÙƒØ² Ø­Ø§Ù…Ù„ Ø§Ù„Ù…Ø³Ùƒ Ù„ØªØ­ÙÙŠØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h1>
                        <p class="text-emerald-100">Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø­ÙØ¸</p>
                    </div>
                </div>
                <div class="text-left">
                    <div class="text-sm text-emerald-100">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                    <div class="font-bold" id="currentWeek"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        <!-- Navigation Tabs -->
        <div class="bg-white rounded-lg shadow-md mb-8 no-print">
            <div class="flex flex-wrap border-b">
                <button onclick="showTab('group1')" id="tab-group1" class="flex-1 min-w-0 py-4 px-3 text-center font-semibold border-b-2 border-emerald-500 text-emerald-600 bg-emerald-50 text-sm">
                    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰<br><span class="text-xs">Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¨Ø¯ÙˆØ±</span>
                </button>
                <button onclick="showTab('group2')" id="tab-group2" class="flex-1 min-w-0 py-4 px-3 text-center font-semibold text-gray-600 hover:text-emerald-600 hover:bg-emerald-50 transition-colors text-sm">
                    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©<br><span class="text-xs">Ø§Ù„Ø´ÙŠØ® Ù…Ø¹ØªØµÙ… Ø§Ù„ØªÙ…ÙŠÙ…ÙŠ</span>
                </button>
                <button onclick="showTab('group3')" id="tab-group3" class="flex-1 min-w-0 py-4 px-3 text-center font-semibold text-gray-600 hover:text-emerald-600 hover:bg-emerald-50 transition-colors text-sm">
                    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©<br><span class="text-xs">Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø§Ø¯Ø© Ø¬Ù„Ø§Ù„</span>
                </button>
                <button onclick="showTab('group4')" id="tab-group4" class="flex-1 min-w-0 py-4 px-3 text-center font-semibold text-gray-600 hover:text-emerald-600 hover:bg-emerald-50 transition-colors text-sm">
                    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©<br><span class="text-xs">Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø±</span>
                </button>
                <button onclick="showSupervisorTab()" id="tab-supervisor" class="flex-1 min-w-0 py-4 px-3 text-center font-semibold text-gray-600 hover:text-emerald-600 hover:bg-emerald-50 transition-colors text-sm">
                    Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ù…Ø´Ø±Ù<br><span class="text-xs">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø©</span>
                </button>
            </div>
        </div>

        <!-- Group Templates (Groups 1-4) -->
        <div id="content-group1" class="tab-content fade-in">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-emerald-100 text-emerald-600 px-3 py-1 rounded-full text-sm ml-3">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</span>
                    Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¨Ø¯ÙˆØ±
                </h2>
                
                <!-- Day Selection -->
                <div class="mb-6 no-print">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…:</label>
                    <div class="flex space-x-4 space-x-reverse">
                        <button onclick="selectDay('group1', 'wednesday')" id="group1-wed" class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors">
                            Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡
                        </button>
                        <button onclick="selectDay('group1', 'saturday')" id="group1-sat" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                            Ø§Ù„Ø³Ø¨Øª
                        </button>
                    </div>
                </div>

                <!-- Students Table -->
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-emerald-50">
                                <th class="border border-gray-300 px-4 py-3 text-right font-semibold">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø­Ø§Ø¶Ø±/ØºØ§Ø¦Ø¨)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ø­ÙØ¸ (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©)</th>
                            </tr>
                        </thead>
                        <tbody id="group1-students"></tbody>
                    </table>
                </div>

                <!-- Group Statistics -->
                <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-blue-600" id="group1-present">0</div>
                        <div class="text-sm text-blue-600">Ø­Ø§Ø¶Ø±</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-red-600" id="group1-absent">0</div>
                        <div class="text-sm text-red-600">ØºØ§Ø¦Ø¨</div>
                    </div>
                    <div class="bg-emerald-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-emerald-600" id="group1-total-pages">0</div>
                        <div class="text-sm text-emerald-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</div>
                    </div>
                </div>

                <!-- Absent Students List -->
                <div class="mt-6 bg-red-50 p-4 rounded-lg" id="group1-absent-list" style="display: none;">
                    <h3 class="text-lg font-semibold text-red-800 mb-3">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØºÙŠØ§Ø¨:</h3>
                    <div class="text-red-700" id="group1-absent-names"></div>
                </div>

                <!-- Honor Roll -->
                <div class="mt-6 bg-yellow-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-3">ğŸ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±Ù - Ø£ÙƒØ«Ø± Ø§Ù„Ø·Ù„Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²Ø§Ù‹:</h3>
                    <div id="group1-honor-roll" class="space-y-2"></div>
                </div>
            </div>
        </div>

        <!-- Similar structure for groups 2, 3, 4 -->
        <div id="content-group2" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-teal-100 text-teal-600 px-3 py-1 rounded-full text-sm ml-3">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</span>
                    Ø§Ù„Ø´ÙŠØ® Ù…Ø¹ØªØµÙ… Ø§Ù„ØªÙ…ÙŠÙ…ÙŠ
                </h2>
                
                <div class="mb-6 no-print">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…:</label>
                    <div class="flex space-x-4 space-x-reverse">
                        <button onclick="selectDay('group2', 'wednesday')" id="group2-wed" class="px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-colors">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</button>
                        <button onclick="selectDay('group2', 'saturday')" id="group2-sat" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">Ø§Ù„Ø³Ø¨Øª</button>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-teal-50">
                                <th class="border border-gray-300 px-4 py-3 text-right font-semibold">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø­Ø§Ø¶Ø±/ØºØ§Ø¦Ø¨)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ø­ÙØ¸ (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©)</th>
                            </tr>
                        </thead>
                        <tbody id="group2-students"></tbody>
                    </table>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-blue-600" id="group2-present">0</div>
                        <div class="text-sm text-blue-600">Ø­Ø§Ø¶Ø±</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-red-600" id="group2-absent">0</div>
                        <div class="text-sm text-red-600">ØºØ§Ø¦Ø¨</div>
                    </div>
                    <div class="bg-teal-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-teal-600" id="group2-total-pages">0</div>
                        <div class="text-sm text-teal-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</div>
                    </div>
                </div>

                <!-- Absent Students List -->
                <div class="mt-6 bg-red-50 p-4 rounded-lg" id="group2-absent-list" style="display: none;">
                    <h3 class="text-lg font-semibold text-red-800 mb-3">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØºÙŠØ§Ø¨:</h3>
                    <div class="text-red-700" id="group2-absent-names"></div>
                </div>

                <!-- Honor Roll -->
                <div class="mt-6 bg-yellow-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-3">ğŸ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±Ù - Ø£ÙƒØ«Ø± Ø§Ù„Ø·Ù„Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²Ø§Ù‹:</h3>
                    <div id="group2-honor-roll" class="space-y-2"></div>
                </div>
            </div>
        </div>

        <div id="content-group3" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-purple-100 text-purple-600 px-3 py-1 rounded-full text-sm ml-3">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©</span>
                    Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø§Ø¯Ø© Ø¬Ù„Ø§Ù„
                </h2>
                
                <div class="mb-6 no-print">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…:</label>
                    <div class="flex space-x-4 space-x-reverse">
                        <button onclick="selectDay('group3', 'wednesday')" id="group3-wed" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</button>
                        <button onclick="selectDay('group3', 'saturday')" id="group3-sat" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">Ø§Ù„Ø³Ø¨Øª</button>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-purple-50">
                                <th class="border border-gray-300 px-4 py-3 text-right font-semibold">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø­Ø§Ø¶Ø±/ØºØ§Ø¦Ø¨)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ø­ÙØ¸ (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©)</th>
                            </tr>
                        </thead>
                        <tbody id="group3-students"></tbody>
                    </table>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-blue-600" id="group3-present">0</div>
                        <div class="text-sm text-blue-600">Ø­Ø§Ø¶Ø±</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-red-600" id="group3-absent">0</div>
                        <div class="text-sm text-red-600">ØºØ§Ø¦Ø¨</div>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-purple-600" id="group3-total-pages">0</div>
                        <div class="text-sm text-purple-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</div>
                    </div>
                </div>

                <!-- Absent Students List -->
                <div class="mt-6 bg-red-50 p-4 rounded-lg" id="group3-absent-list" style="display: none;">
                    <h3 class="text-lg font-semibold text-red-800 mb-3">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØºÙŠØ§Ø¨:</h3>
                    <div class="text-red-700" id="group3-absent-names"></div>
                </div>

                <!-- Honor Roll -->
                <div class="mt-6 bg-yellow-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-3">ğŸ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±Ù - Ø£ÙƒØ«Ø± Ø§Ù„Ø·Ù„Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²Ø§Ù‹:</h3>
                    <div id="group3-honor-roll" class="space-y-2"></div>
                </div>
            </div>
        </div>

        <div id="content-group4" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="bg-orange-100 text-orange-600 px-3 py-1 rounded-full text-sm ml-3">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©</span>
                    Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø±
                </h2>
                
                <div class="mb-6 no-print">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…:</label>
                    <div class="flex space-x-4 space-x-reverse">
                        <button onclick="selectDay('group4', 'wednesday')" id="group4-wed" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</button>
                        <button onclick="selectDay('group4', 'saturday')" id="group4-sat" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">Ø§Ù„Ø³Ø¨Øª</button>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-orange-50">
                                <th class="border border-gray-300 px-4 py-3 text-right font-semibold">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø­Ø§Ø¶Ø±/ØºØ§Ø¦Ø¨)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ø­ÙØ¸ (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (ØµÙØ­Ø§Øª)</th>
                                <th class="border border-gray-300 px-4 py-3 text-center font-semibold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©)</th>
                            </tr>
                        </thead>
                        <tbody id="group4-students"></tbody>
                    </table>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-blue-600" id="group4-present">0</div>
                        <div class="text-sm text-blue-600">Ø­Ø§Ø¶Ø±</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-red-600" id="group4-absent">0</div>
                        <div class="text-sm text-red-600">ØºØ§Ø¦Ø¨</div>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg text-center">
                        <div class="text-2xl font-bold text-orange-600" id="group4-total-pages">0</div>
                        <div class="text-sm text-orange-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</div>
                    </div>
                </div>

                <!-- Absent Students List -->
                <div class="mt-6 bg-red-50 p-4 rounded-lg" id="group4-absent-list" style="display: none;">
                    <h3 class="text-lg font-semibold text-red-800 mb-3">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØºÙŠØ§Ø¨:</h3>
                    <div class="text-red-700" id="group4-absent-names"></div>
                </div>

                <!-- Honor Roll -->
                <div class="mt-6 bg-yellow-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-3">ğŸ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±Ù - Ø£ÙƒØ«Ø± Ø§Ù„Ø·Ù„Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²Ø§Ù‹:</h3>
                    <div id="group4-honor-roll" class="space-y-2"></div>
                </div>
            </div>
        </div>

        <!-- Supervisor Statistics -->
        <div id="content-supervisor" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="bg-indigo-100 text-indigo-600 px-3 py-1 rounded-full text-sm ml-3">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø©</span>
                        Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ù…Ø´Ø±Ù
                    </h2>
                    
                    <!-- Export and Print Buttons -->
                    <div class="flex space-x-4 space-x-reverse no-print">
                        <button onclick="exportToCSV()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center">
                            <svg class="w-4 h-4 ml-2" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M3 17a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z"/>
                            </svg>
                            ØªØµØ¯ÙŠØ± CSV
                        </button>
                        <button onclick="printReport()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                            <svg class="w-4 h-4 ml-2" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2z"/>
                            </svg>
                            Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                        </button>
                        <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                            ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
                        </button>
                    </div>
                </div>

                <!-- Overall Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="total-students">55</div>
                        <div class="text-blue-100">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                    </div>
                    <div class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="total-present">0</div>
                        <div class="text-emerald-100">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¶ÙˆØ±</div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="total-memorized">0</div>
                        <div class="text-purple-100">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</div>
                    </div>
                    <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold" id="total-reviewed">0</div>
                        <div class="text-orange-100">Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
                    </div>
                </div>

                <!-- Group Comparison -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-emerald-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-emerald-800 mb-4">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¨Ø¯ÙˆØ±</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:</span>
                                <span class="font-bold">14</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…:</span>
                                <span class="font-bold text-emerald-600" id="group1-today-present">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</span>
                                <span class="font-bold text-emerald-600" id="group1-supervisor-pages">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-teal-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-teal-800 mb-4">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© - Ø§Ù„Ø´ÙŠØ® Ù…Ø¹ØªØµÙ… Ø§Ù„ØªÙ…ÙŠÙ…ÙŠ</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:</span>
                                <span class="font-bold">15</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…:</span>
                                <span class="font-bold text-teal-600" id="group2-today-present">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</span>
                                <span class="font-bold text-teal-600" id="group2-supervisor-pages">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-purple-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-purple-800 mb-4">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© - Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø§Ø¯Ø© Ø¬Ù„Ø§Ù„</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:</span>
                                <span class="font-bold">13</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…:</span>
                                <span class="font-bold text-purple-600" id="group3-today-present">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</span>
                                <span class="font-bold text-purple-600" id="group3-supervisor-pages">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-orange-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-orange-800 mb-4">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© - Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø±</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:</span>
                                <span class="font-bold">13</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…:</span>
                                <span class="font-bold text-orange-600" id="group4-today-present">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</span>
                                <span class="font-bold text-orange-600" id="group4-supervisor-pages">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Overall Absent Students -->
                <div class="mt-8 bg-red-50 p-6 rounded-lg" id="supervisor-absent-list" style="display: none;">
                    <h3 class="text-xl font-semibold text-red-800 mb-4">ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø´Ø§Ù…Ù„Ø©:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div>
                            <h4 class="font-semibold text-emerald-700 mb-2">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰:</h4>
                            <div class="text-red-700 text-sm" id="supervisor-group1-absent"></div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-teal-700 mb-2">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©:</h4>
                            <div class="text-red-700 text-sm" id="supervisor-group2-absent"></div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-purple-700 mb-2">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©:</h4>
                            <div class="text-red-700 text-sm" id="supervisor-group3-absent"></div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-orange-700 mb-2">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©:</h4>
                            <div class="text-red-700 text-sm" id="supervisor-group4-absent"></div>
                        </div>
                    </div>
                </div>

                <!-- Overall Honor Roll -->
                <div class="mt-8 bg-yellow-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold text-yellow-800 mb-4">ğŸ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±Ù Ø§Ù„Ø´Ø§Ù…Ù„Ø© - Ø£ÙƒØ«Ø± Ø§Ù„Ø·Ù„Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²Ø§Ù‹:</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded-lg">
                            <h4 class="font-semibold text-emerald-700 mb-3">ğŸ¥‡ Ø§Ù„Ø£ÙˆØ§Ø¦Ù„ ÙÙŠ Ø§Ù„Ø­ÙØ¸:</h4>
                            <div id="supervisor-memorization-honor" class="space-y-2"></div>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-700 mb-3">ğŸ¥‡ Ø§Ù„Ø£ÙˆØ§Ø¦Ù„ ÙÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:</h4>
                            <div id="supervisor-review-honor" class="space-y-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Student data
        const students = {
            group1: [
                "Ø£Ø­Ù…Ø¯ Ø±Ø§Ù…ÙŠ Ø¹Ø²Ù…ÙŠ Ø£Ø¨Ùˆ Ø®Ø¶Ø±", "Ø¥Ø³Ø­Ø§Ù‚ Ù…Ø­Ù…ÙˆØ¯ Ø¹Ù…Ø± Ø³Ù„ÙŠÙ…Ø§Ù†", "Ø¶ÙŠØ§Ø¡ Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯ Ø§Ù„Ø¨Ø±ØºÙˆØ«ÙŠ",
                "Ø¹Ø¨Ø§Ø¯Ø© Ù…Ø±Ø§Ø¯ Ø²Ù‡ÙŠØ± Ø§Ù„Ø­Ø¯Ø§Ø¯", "Ø¹Ø¨ÙŠØ¯Ø© Ø¹Ø§Ù…Ø± Ø®Ù„ÙŠÙ„ ØµØ¨Ø­Ø©", "Ø¹Ø¨ÙŠØ¯Ø© Ù…ØµØ¹Ø¨ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¨Ø±ØºÙˆØ«ÙŠ",
                "Ø¹Ø¯ÙŠ Ø­Ø³ÙŠÙ† ÙØªØ­ÙŠ Ø§Ù„Ù‚ÙŠØ³ÙŠ", "Ø¹Ù…Ø±Ø§Ù† Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ Ø³Ø¹ÙŠØ¯ ÙƒÙ†Ø§Ù†Ø©", "Ù…Ø­Ù…Ø¯ Ø­Ù…Ø²Ø© Ù…Ø­Ù…Ø¯ Ù‡Ø¯ÙŠØ¨",
                "Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ù†Ø§ÙŠÙ Ø¹Ø¬ÙˆØ©", "Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù„Ø­Ø§Ù…", "Ù…Ø¤Ù…Ù† Ø¨ÙƒØ± Ø§Ù„Ù‡Ù†Ø¯Ø§ÙˆÙŠ",
                "Ù†ØµØ± Ø¹Ø§Ø·Ù Ù†ØµØ± Ø§Ù„Ø­Ø¬ÙˆØ¬", "ÙŠÙˆØ³Ù Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯ Ù…Ù„Ø­Ù…"
            ],
            group2: [
                "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø®ÙˆØ§Ù„Ø¯Ø©", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù…Ø¹ØªØ² ØµØ¨Ø­ÙŠ Ø§Ù„Ø­Ø§Ù…Ø¯", "Ø£Ø­Ù…Ø¯ ÙˆÙ„ÙŠØ¯ Ø±Ø¬Ø§Ø¦ÙŠ Ø§Ù„ØºØ¶Ø¨Ø§Ù†",
                "Ø¨Ø´Ø§Ø± Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ Ø³Ø¹ÙŠØ¯ ÙƒÙ†Ø§Ù†Ø©", "Ø¬Ù…ÙŠÙ„ ØµØ§Ù„Ø­ Ø¬Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø±ØºÙˆØ«ÙŠ", "Ø®Ø§Ù„Ø¯ Ù…Ø­Ù…Ø¯ Ø®Ø§Ù„Ø¯ Ø¯Ø§ÙˆØ¯",
                "Ø±ÙŠØ§Ù† ÙŠÙˆØ³Ù Ù†ÙˆØ± Ù…Ø§Ø¯Ø¨Ø±", "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø£ÙŠÙ…Ù† Ø³Ù„ÙŠÙ… Ø§Ù„Ø´Ø¨ÙŠØ·Ø©", "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø±Ù‚ Ù†Ø§ÙŠÙ Ø¹Ø¬ÙˆØ©",
                "Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ù„Ùƒ Ø¬Ù„Ø§Ù„ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ø®Ù„Ø§ÙŠÙ„Ø©", "Ø¹Ø«Ù…Ø§Ù† Ø£Ø­Ù…Ø¯ Ù†ÙˆØ± Ø§Ù„Ø®Ø¶Ø±ÙŠ", "Ù…Ø­Ù…Ø¯ Ø®Ø¶Ø± Ø¹Ø¨Ø¯ Ø±Ø¨Ù‡ Ø¯Ø§ÙˆØ¯",
                "Ù…Ø­Ù…Ø¯ Ù†ÙˆØ± Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ø£Ø­Ù…Ø¯", "Ù…Ø­Ù…ÙˆØ¯ Ø¹Ù…Ø§Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù„Ø­Ø§Ù…", "Ù†ÙˆØ± ÙŠØ§Ø³ÙŠÙ† Ù†ÙˆØ± Ù…Ø§Ø¯Ø¨Ø±"
            ],
            group3: [
                "Ø¢Ø¯Ù… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¹Ø¨Ø¯ Ø±Ø¨Ù‡ Ø¯Ø§ÙˆØ¯", "Ø£Ø³Ø§Ù…Ø© Ù…Ø­Ù…Ø¯ Ø³Ø¹Ø¯Ø§Øª Ø¯Ø§Ø± Ø­Ø³Ø§Ù†", "Ø¨ÙƒØ± Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø¹ÙŠØ§ØµØ±Ø©",
                "Ø­Ù…Ø²Ø© Ù…Ø­Ù…ÙˆØ¯ Ø¬Ø¨Ø±ÙŠÙ† Ù…Ø­Ù…Ø¯", "Ø²ÙŠØ¯ Ù…Ø­Ù…Ø¯ Ù†ØµØ± Ø§Ù„Ø­Ø¬ÙˆØ¬", "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ØªÙˆÙÙŠÙ‚ Ø§Ù„ØªÙ…ÙŠÙ…ÙŠ",
                "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø£Ù…ÙŠÙ† Ø­Ø³Ù† Ø§Ù„Ø£Ø´Ù‚Ø±", "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ù…Ø­Ù…ÙˆØ¯ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ Ø¨Ù†Ø§Øª", "Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø²ÙŠØ² Ø£Ø­Ù…Ø¯ Ù†ÙˆØ± Ø§Ù„Ø®Ø¶Ø±ÙŠ",
                "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø®Ø§Ù„Ø¯ ØµØ¨Ø­ÙŠ Ø­Ø³ÙŠÙ†", "Ø¹Ù…Ø± Ø¨Ø³Ø§Ù… Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ù„Ø­Ø§Ù…", "ÙÙŠØµÙ„ Ø¨Ù„Ø§Ù„ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø±Ø¨Ø¹ÙŠ",
                "Ù…Ø¹Ø§Ø° Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¬Ø¨Ø±"
            ],
            group4: [
                "Ø­Ø°ÙŠÙØ© Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø¹ÙŠØ§ØµØ±Ø©", "Ø¶ÙŠØ§Ø¡ Ø§Ù„Ø¯ÙŠÙ† Ø£Ù†Ø³ Ø¹ÙˆØ¶ Ø§Ù„Ø®Ø·ÙŠØ¨", "Ø§Ù„Ø¹Ø¨Ø§Ø³ Ù…Ø­Ù…ÙˆØ¯ ØµØ§Ù„Ø­ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡",
                "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¹Ø§Ù…Ø± Ø®Ù„ÙŠÙ„ ØµØ¨Ø­Ø©", "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…ÙˆØ¯ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ Ø¨Ù†Ø§Øª", "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…ÙˆØ¯ Ø¬Ø¨Ø±ÙŠÙ† Ù…Ø­Ù…Ø¯",
                "Ø¹Ù…Ø± Ù…Ø¤ÙŠØ¯ ØµØ¨Ø­ÙŠ Ø§Ù„Ø­Ø§Ù…Ø¯", "Ø¹Ù†Ø§Ù† Ø¹Ù…Ø± Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ø¨Ø±ØºÙˆØ«ÙŠ", "Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø®ÙˆØ§Ù„Ø¯Ø©",
                "Ù…Ø­Ù…Ø¯ ØµØ§Ù„Ø­ Ø¬Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø±ØºÙˆØ«ÙŠ", "Ù…ØµØ·ÙÙ‰ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ… Ù‚Ø¨Ø¹Ø©", "Ù…Ø¹Ø§Ø° Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ØµÙ‚Ø± Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø²Ø§Ù‚",
                "ÙˆØ³Ø§Ù… ÙŠÙˆØ³Ù Ø¬Ø¨Ø±ÙŠÙ† Ù…Ø­Ù…Ø¯"
            ]
        };

        const teachers = {
            group1: "Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¨Ø¯ÙˆØ±",
            group2: "Ø§Ù„Ø´ÙŠØ® Ù…Ø¹ØªØµÙ… Ø§Ù„ØªÙ…ÙŠÙ…ÙŠ", 
            group3: "Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø§Ø¯Ø© Ø¬Ù„Ø§Ù„",
            group4: "Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø±"
        };

        // Password for supervisor access
        const SUPERVISOR_PASSWORD = "Ù…Ø´Ø±Ù2024";
        let isLoggedIn = false;

        // Current selections
        let currentGroup = 'group1';
        let currentDay = 'wednesday';

        // Initialize the system
        function init() {
            updateCurrentWeek();
            ['group1', 'group2', 'group3', 'group4'].forEach(group => {
                populateStudents(group);
                selectDay(group, 'wednesday');
                // Set default attendance to present and update stats
                setTimeout(() => {
                    updateStats(group);
                }, 100);
            });
        }

        // Update current week display
        function updateCurrentWeek() {
            const now = new Date();
            const weekStart = new Date(now);
            weekStart.setDate(now.getDate() - now.getDay() + 3); // Wednesday
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 3); // Saturday
            
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentWeek').textContent = 
                `${weekStart.toLocaleDateString('ar-SA', options)} - ${weekEnd.toLocaleDateString('ar-SA', options)}`;
        }

        // Show tab content
        function showTab(tab) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('[id^="tab-"]').forEach(tabBtn => {
                tabBtn.className = tabBtn.className.replace(/border-b-2 border-\w+-500 text-\w+-600 bg-\w+-50/, 'text-gray-600 hover:text-emerald-600 hover:bg-emerald-50');
            });
            
            // Show selected tab content
            document.getElementById(`content-${tab}`).classList.remove('hidden');
            
            // Add active class to selected tab
            const activeTab = document.getElementById(`tab-${tab}`);
            activeTab.className = activeTab.className.replace('text-gray-600 hover:text-emerald-600 hover:bg-emerald-50', 'border-b-2 border-emerald-500 text-emerald-600 bg-emerald-50');
        }

        // Show supervisor tab with password protection
        function showSupervisorTab() {
            if (!isLoggedIn) {
                document.getElementById('loginModal').classList.remove('hidden');
                document.getElementById('passwordInput').focus();
            } else {
                showTab('supervisor');
                updateSupervisorStats();
            }
        }

        // Check password
        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === SUPERVISOR_PASSWORD) {
                isLoggedIn = true;
                closeLoginModal();
                showTab('supervisor');
                updateSupervisorStats();
            } else {
                document.getElementById('loginError').classList.remove('hidden');
                document.getElementById('passwordInput').value = '';
            }
        }

        // Close login modal
        function closeLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('loginError').classList.add('hidden');
            document.getElementById('passwordInput').value = '';
        }

        // Logout
        function logout() {
            isLoggedIn = false;
            showTab('group1');
        }

        // Handle Enter key in password input
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkPassword();
                }
            });
        });

        // Select day
        function selectDay(group, day) {
            currentGroup = group;
            currentDay = day;
            
            // Update button styles
            const colors = {
                group1: 'emerald',
                group2: 'teal', 
                group3: 'purple',
                group4: 'orange'
            };
            const color = colors[group];
            
            document.getElementById(`${group}-wed`).className = 
                day === 'wednesday' 
                ? `px-4 py-2 bg-${color}-500 text-white rounded-lg hover:bg-${color}-600 transition-colors`
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors';
            
            document.getElementById(`${group}-sat`).className = 
                day === 'saturday' 
                ? `px-4 py-2 bg-${color}-500 text-white rounded-lg hover:bg-${color}-600 transition-colors`
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors';
        }

        // Populate students table
        function populateStudents(group) {
            const tbody = document.getElementById(`${group}-students`);
            tbody.innerHTML = '';
            
            students[group].forEach((student, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="border border-gray-300 px-4 py-3">
                        <div class="student-name student-present" onclick="toggleStudentAttendance(this, '${group}')" data-status="present">
                            ${student}
                        </div>
                    </td>
                    <td class="border border-gray-300 px-4 py-3 text-center">
                        <div class="flex items-center justify-center space-x-2 space-x-reverse">
                            <button onclick="changePages(this, -1, '${group}')" class="bg-red-500 hover:bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold transition-colors">
                                -
                            </button>
                            <span class="memorization-value text-lg font-bold text-emerald-600 min-w-[2rem] text-center">0</span>
                            <button onclick="changePages(this, 1, '${group}')" class="bg-emerald-500 hover:bg-emerald-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold transition-colors">
                                +
                            </button>
                        </div>
                    </td>
                    <td class="border border-gray-300 px-4 py-3 text-center">
                        <div class="flex items-center justify-center space-x-2 space-x-reverse">
                            <button onclick="changePages(this, -1, '${group}')" class="bg-red-500 hover:bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold transition-colors">
                                -
                            </button>
                            <span class="review-value text-lg font-bold text-blue-600 min-w-[2rem] text-center">0</span>
                            <button onclick="changePages(this, 1, '${group}')" class="bg-blue-500 hover:bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold transition-colors">
                                +
                            </button>
                        </div>
                    </td>
                    <td class="border border-gray-300 px-4 py-3 text-center">
                        <input type="text" placeholder="Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©..." 
                               class="notes-input w-24 px-2 py-1 border border-gray-300 rounded text-sm text-center focus:outline-none focus:ring-2 focus:ring-emerald-500">
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Toggle student attendance by clicking on name
        function toggleStudentAttendance(nameElement, group) {
            const currentStatus = nameElement.dataset.status;
            const row = nameElement.closest('tr');
            const memorizationCell = row.querySelector('td:nth-child(2)');
            const reviewCell = row.querySelector('td:nth-child(3)');
            
            if (currentStatus === 'present') {
                // Change to absent
                nameElement.dataset.status = 'absent';
                nameElement.className = 'student-name student-absent';
                
                // Disable buttons and reset values
                memorizationCell.classList.add('disabled-buttons');
                reviewCell.classList.add('disabled-buttons');
                memorizationCell.querySelector('.memorization-value').textContent = '0';
                reviewCell.querySelector('.review-value').textContent = '0';
            } else {
                // Change to present
                nameElement.dataset.status = 'present';
                nameElement.className = 'student-name student-present';
                
                // Enable buttons
                memorizationCell.classList.remove('disabled-buttons');
                reviewCell.classList.remove('disabled-buttons');
            }
            
            updateStats(group);
        }

        // Change pages count with buttons
        function changePages(button, change, group) {
            const valueSpan = button.parentElement.querySelector('.memorization-value, .review-value');
            let currentValue = parseInt(valueSpan.textContent);
            let newValue = currentValue + change;
            
            // Ensure value stays within bounds (1-10)
            if (newValue < 1) newValue = 1;
            if (newValue > 10) newValue = 10;
            
            valueSpan.textContent = newValue;
            updateStats(group);
        }

        // Update statistics
        function updateStats(group) {
            const rows = document.querySelectorAll(`#${group}-students tr`);
            let present = 0, absent = 0, totalPages = 0;
            let absentStudents = [];
            let studentsData = [];
            
            rows.forEach(row => {
                const nameElement = row.querySelector('.student-name');
                const attendance = nameElement?.dataset.status || 'present';
                const memorization = parseInt(row.querySelector('.memorization-value')?.textContent) || 0;
                const review = parseInt(row.querySelector('.review-value')?.textContent) || 0;
                const studentName = nameElement.textContent.trim();
                
                if (attendance === 'present') {
                    present++;
                    totalPages += memorization;
                    studentsData.push({
                        name: studentName,
                        memorization: memorization,
                        review: review,
                        total: memorization + review
                    });
                } else if (attendance === 'absent') {
                    absent++;
                    absentStudents.push(studentName);
                }
            });
            
            document.getElementById(`${group}-present`).textContent = present;
            document.getElementById(`${group}-absent`).textContent = absent;
            document.getElementById(`${group}-total-pages`).textContent = totalPages;
            
            // Update absent students list
            const absentListDiv = document.getElementById(`${group}-absent-list`);
            const absentNamesDiv = document.getElementById(`${group}-absent-names`);
            
            if (absentStudents.length > 0) {
                absentListDiv.style.display = 'block';
                absentNamesDiv.innerHTML = absentStudents.map(name => `â€¢ ${name}`).join('<br>');
            } else {
                absentListDiv.style.display = 'none';
            }
            
            // Update honor roll
            updateHonorRoll(group, studentsData);
        }
        
        // Update honor roll for a group
        function updateHonorRoll(group, studentsData) {
            const honorRollDiv = document.getElementById(`${group}-honor-roll`);
            
            // Sort by total achievement (memorization + review)
            const topStudents = studentsData
                .filter(student => student.total > 0)
                .sort((a, b) => b.total - a.total)
                .slice(0, 5);
            
            if (topStudents.length > 0) {
                const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ…', 'â­'];
                honorRollDiv.innerHTML = topStudents.map((student, index) => 
                    `<div class="flex justify-between items-center bg-white p-2 rounded border">
                        <span>${medals[index]} ${student.name}</span>
                        <span class="text-sm text-gray-600">Ø­ÙØ¸: ${student.memorization} | Ù…Ø±Ø§Ø¬Ø¹Ø©: ${student.review} | Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${student.total}</span>
                    </div>`
                ).join('');
            } else {
                honorRollDiv.innerHTML = '<div class="text-gray-500 text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø¨Ø¹Ø¯</div>';
            }
        }

        // Update supervisor statistics
        function updateSupervisorStats() {
            let totalPresent = 0, totalMemorized = 0, totalReviewed = 0;
            let allStudentsData = [];
            let hasAbsentStudents = false;
            
            ['group1', 'group2', 'group3', 'group4'].forEach(group => {
                const present = parseInt(document.getElementById(`${group}-present`).textContent) || 0;
                const pages = parseInt(document.getElementById(`${group}-total-pages`).textContent) || 0;
                
                totalPresent += present;
                totalMemorized += pages;
                
                document.getElementById(`${group}-today-present`).textContent = present;
                document.getElementById(`${group}-supervisor-pages`).textContent = pages;
                
                // Collect absent students for supervisor view
                const rows = document.querySelectorAll(`#${group}-students tr`);
                let groupAbsentStudents = [];
                
                rows.forEach(row => {
                    const nameElement = row.querySelector('.student-name');
                    const attendance = nameElement?.dataset.status || 'present';
                    const memorization = parseInt(row.querySelector('.memorization-value')?.textContent) || 0;
                    const review = parseInt(row.querySelector('.review-value')?.textContent) || 0;
                    const studentName = nameElement.textContent.trim();
                    
                    if (attendance === 'absent') {
                        groupAbsentStudents.push(studentName);
                        hasAbsentStudents = true;
                    } else if (attendance === 'present') {
                        totalReviewed += review;
                        allStudentsData.push({
                            name: studentName,
                            group: group,
                            memorization: memorization,
                            review: review,
                            total: memorization + review
                        });
                    }
                });
                
                // Update group absent list in supervisor view
                const groupAbsentDiv = document.getElementById(`supervisor-${group}-absent`);
                if (groupAbsentStudents.length > 0) {
                    groupAbsentDiv.innerHTML = groupAbsentStudents.map(name => `â€¢ ${name}`).join('<br>');
                } else {
                    groupAbsentDiv.innerHTML = '<span class="text-green-600">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØºÙŠØ§Ø¨</span>';
                }
            });
            
            document.getElementById('total-present').textContent = totalPresent;
            document.getElementById('total-memorized').textContent = totalMemorized;
            document.getElementById('total-reviewed').textContent = totalReviewed;
            
            // Show/hide absent students section
            const supervisorAbsentList = document.getElementById('supervisor-absent-list');
            if (hasAbsentStudents) {
                supervisorAbsentList.style.display = 'block';
            } else {
                supervisorAbsentList.style.display = 'none';
            }
            
            // Update overall honor roll
            updateSupervisorHonorRoll(allStudentsData);
        }
        
        // Update supervisor honor roll
        function updateSupervisorHonorRoll(allStudentsData) {
            // Top memorizers
            const topMemorizers = allStudentsData
                .filter(student => student.memorization > 0)
                .sort((a, b) => b.memorization - a.memorization)
                .slice(0, 10);
            
            // Top reviewers
            const topReviewers = allStudentsData
                .filter(student => student.review > 0)
                .sort((a, b) => b.review - a.review)
                .slice(0, 10);
            
            const memorizationHonorDiv = document.getElementById('supervisor-memorization-honor');
            const reviewHonorDiv = document.getElementById('supervisor-review-honor');
            
            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ…', 'â­', 'ğŸŒŸ', 'âœ¨', 'ğŸ’«', 'ğŸ–ï¸', 'ğŸ†'];
            const groupColors = {
                group1: 'text-emerald-600',
                group2: 'text-teal-600', 
                group3: 'text-purple-600',
                group4: 'text-orange-600'
            };
            
            if (topMemorizers.length > 0) {
                memorizationHonorDiv.innerHTML = topMemorizers.map((student, index) => 
                    `<div class="flex justify-between items-center bg-gray-50 p-2 rounded border">
                        <span>${medals[index]} ${student.name}</span>
                        <div class="text-sm">
                            <span class="${groupColors[student.group]}">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${student.group.replace('group', '')}</span>
                            <span class="text-emerald-600 font-bold ml-2">${student.memorization} ØµÙØ­Ø©</span>
                        </div>
                    </div>`
                ).join('');
            } else {
                memorizationHonorDiv.innerHTML = '<div class="text-gray-500 text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ÙÙŠ Ø§Ù„Ø­ÙØ¸ Ø¨Ø¹Ø¯</div>';
            }
            
            if (topReviewers.length > 0) {
                reviewHonorDiv.innerHTML = topReviewers.map((student, index) => 
                    `<div class="flex justify-between items-center bg-gray-50 p-2 rounded border">
                        <span>${medals[index]} ${student.name}</span>
                        <div class="text-sm">
                            <span class="${groupColors[student.group]}">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${student.group.replace('group', '')}</span>
                            <span class="text-blue-600 font-bold ml-2">${student.review} ØµÙØ­Ø©</span>
                        </div>
                    </div>`
                ).join('');
            } else {
                reviewHonorDiv.innerHTML = '<div class="text-gray-500 text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ÙÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø¹Ø¯</div>';
            }
        }

        // Export to CSV with Arabic support
        function exportToCSV() {
            // Add BOM for proper UTF-8 encoding in Excel
            let csvContent = "\uFEFF";
            
            // Add header with proper Arabic formatting
            csvContent += "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©,Ø§Ù„Ø´ÙŠØ®,Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨,Ø§Ù„Ø­Ø¶ÙˆØ±,Ø§Ù„Ø­ÙØ¸ (ØµÙØ­Ø§Øª),Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (ØµÙØ­Ø§Øª),Ù…Ù„Ø§Ø­Ø¸Ø§Øª\n";
            
            ['group1', 'group2', 'group3', 'group4'].forEach(group => {
                const rows = document.querySelectorAll(`#${group}-students tr`);
                const groupNum = group.replace('group', '');
                const teacher = teachers[group];
                
                rows.forEach(row => {
                    const nameElement = row.querySelector('.student-name');
                    const studentName = nameElement.textContent.trim();
                    const attendance = nameElement.dataset.status || 'present';
                    const memorization = row.querySelector('.memorization-value')?.textContent || '1';
                    const review = row.querySelector('.review-value')?.textContent || '1';
                    const notes = row.querySelector('.notes-input')?.value || '';
                    
                    const attendanceArabic = {
                        'present': 'Ø­Ø§Ø¶Ø±',
                        'absent': 'ØºØ§Ø¦Ø¨'
                    };
                    
                    // Wrap text fields in quotes to handle commas and special characters
                    const escapedName = `"${studentName.replace(/"/g, '""')}"`;
                    const escapedTeacher = `"${teacher.replace(/"/g, '""')}"`;
                    const escapedNotes = `"${notes.replace(/"/g, '""')}"`;
                    
                    csvContent += `"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${groupNum}",${escapedTeacher},${escapedName},"${attendanceArabic[attendance]}",${memorization},${review},${escapedNotes}\n`;
                });
            });
            
            // Add summary statistics
            csvContent += "\n--- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø© ---\n";
            csvContent += `"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨","${document.getElementById('total-students').textContent}"\n`;
            csvContent += `"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¶ÙˆØ±","${document.getElementById('total-present').textContent}"\n`;
            csvContent += `"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©","${document.getElementById('total-memorized').textContent}"\n`;
            csvContent += `"Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©","${document.getElementById('total-reviewed').textContent}"\n`;
            
            // Create blob with proper UTF-8 encoding
            const blob = new Blob([csvContent], { 
                type: 'text/csv;charset=utf-8;' 
            });
            
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            
            // Create filename with current date
            const currentDate = new Date();
            const dateString = currentDate.toLocaleDateString('ar-SA').replace(/\//g, '-');
            const timeString = currentDate.toLocaleTimeString('ar-SA', { 
                hour: '2-digit', 
                minute: '2-digit' 
            }).replace(/:/g, '-');
            
            link.setAttribute('download', `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø­Ø¶ÙˆØ±_ÙˆØ§Ù„Ø­ÙØ¸_${dateString}_${timeString}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show success message
            alert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ÙØªØ­ Ø§Ù„Ù…Ù„Ù ÙÙŠ Excel Ø£Ùˆ Ø£ÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¬Ø¯Ø§ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª.');
        }

        // Print report as PDF
        async function printReport() {
            try {
                // Show loading message
                const originalText = event.target.textContent;
                event.target.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ PDF...';
                event.target.disabled = true;
                
                // Create a temporary container for the report
                const reportContainer = document.createElement('div');
                reportContainer.style.cssText = `
                    position: absolute;
                    top: -9999px;
                    left: -9999px;
                    width: 210mm;
                    background: white;
                    padding: 20px;
                    font-family: 'Amiri', serif;
                    direction: rtl;
                `;
                
                // Generate report content
                let reportHTML = `
                    <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #10b981; padding-bottom: 20px;">
                        <h1 style="color: #10b981; font-size: 24px; margin-bottom: 10px;">Ù…Ø±ÙƒØ² Ø­Ø§Ù…Ù„ Ø§Ù„Ù…Ø³Ùƒ Ù„ØªØ­ÙÙŠØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h1>
                        <h2 style="color: #374151; font-size: 18px;">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø­ÙØ¸</h2>
                        <p style="color: #6b7280; font-size: 14px;">Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}</p>
                    </div>
                `;
                
                // Add overall statistics
                reportHTML += `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #374151; font-size: 16px; margin-bottom: 15px; border-bottom: 1px solid #e5e7eb; padding-bottom: 5px;">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h3>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px;">
                            <div style="background: #dbeafe; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 20px; font-weight: bold; color: #1d4ed8;">${document.getElementById('total-students').textContent}</div>
                                <div style="font-size: 12px; color: #1d4ed8;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                            </div>
                            <div style="background: #d1fae5; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 20px; font-weight: bold; color: #059669;">${document.getElementById('total-present').textContent}</div>
                                <div style="font-size: 12px; color: #059669;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¶ÙˆØ±</div>
                            </div>
                            <div style="background: #e9d5ff; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 20px; font-weight: bold; color: #7c3aed;">${document.getElementById('total-memorized').textContent}</div>
                                <div style="font-size: 12px; color: #7c3aed;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</div>
                            </div>
                            <div style="background: #fed7aa; padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 20px; font-weight: bold; color: #ea580c;">${document.getElementById('total-reviewed').textContent}</div>
                                <div style="font-size: 12px; color: #ea580c;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add group details
                const groups = [
                    { id: 'group1', name: 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰', teacher: 'Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¨Ø¯ÙˆØ±', color: '#10b981' },
                    { id: 'group2', name: 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©', teacher: 'Ø§Ù„Ø´ÙŠØ® Ù…Ø¹ØªØµÙ… Ø§Ù„ØªÙ…ÙŠÙ…ÙŠ', color: '#14b8a6' },
                    { id: 'group3', name: 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©', teacher: 'Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø§Ø¯Ø© Ø¬Ù„Ø§Ù„', color: '#8b5cf6' },
                    { id: 'group4', name: 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©', teacher: 'Ø§Ù„Ø´ÙŠØ® Ù…Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø±', color: '#f97316' }
                ];
                
                groups.forEach(group => {
                    const present = document.getElementById(`${group.id}-present`).textContent;
                    const absent = document.getElementById(`${group.id}-absent`).textContent;
                    const pages = document.getElementById(`${group.id}-total-pages`).textContent;
                    
                    reportHTML += `
                        <div style="margin-bottom: 25px; page-break-inside: avoid;">
                            <h3 style="color: ${group.color}; font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid ${group.color}; padding-bottom: 5px;">
                                ${group.name} - ${group.teacher}
                            </h3>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px;">
                                <div style="background: #dbeafe; padding: 10px; border-radius: 6px; text-align: center;">
                                    <div style="font-size: 16px; font-weight: bold; color: #1d4ed8;">${present}</div>
                                    <div style="font-size: 11px; color: #1d4ed8;">Ø­Ø§Ø¶Ø±</div>
                                </div>
                                <div style="background: #fee2e2; padding: 10px; border-radius: 6px; text-align: center;">
                                    <div style="font-size: 16px; font-weight: bold; color: #dc2626;">${absent}</div>
                                    <div style="font-size: 11px; color: #dc2626;">ØºØ§Ø¦Ø¨</div>
                                </div>
                                <div style="background: #d1fae5; padding: 10px; border-radius: 6px; text-align: center;">
                                    <div style="font-size: 16px; font-weight: bold; color: #059669;">${pages}</div>
                                    <div style="font-size: 11px; color: #059669;">ØµÙØ­Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                reportContainer.innerHTML = reportHTML;
                document.body.appendChild(reportContainer);
                
                // Generate PDF using html2canvas and jsPDF
                const canvas = await html2canvas(reportContainer, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#ffffff'
                });
                
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Generate filename with current date
                const currentDate = new Date();
                const dateString = currentDate.toLocaleDateString('ar-SA').replace(/\//g, '-');
                const timeString = currentDate.toLocaleTimeString('ar-SA', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                }).replace(/:/g, '-');
                
                pdf.save(`ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø­Ø¶ÙˆØ±_ÙˆØ§Ù„Ø­ÙØ¸_${dateString}_${timeString}.pdf`);
                
                // Clean up
                document.body.removeChild(reportContainer);
                
                // Restore button
                event.target.textContent = originalText;
                event.target.disabled = false;
                
                alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF Ø¨Ù†Ø¬Ø§Ø­!');
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                
                // Restore button in case of error
                event.target.textContent = 'Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
                event.target.disabled = false;
            }
        }

        // Initialize the system when page loads
        window.onload = init;
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'964b80eba40683cc',t:'MTc1MzQ0NDg5Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
